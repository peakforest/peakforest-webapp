defaultFileDownload=function(a){$(".downloadTemplateSelectUploadFile-"+a).hide();var c=$("#downloadTemplateSpectrumSampleType").val();var b=$("#downloadTemplateSpectrumType").val();if(b=="lc-ms"){$("#generatingTemplate-empty").show();dumpEmptyFile("lcms",c)}else{if(b=="lc-msms"){$("#generatingTemplate-empty").show();dumpEmptyFile("lcmsms",c)}else{if(b=="nmr"){$("#generatingTemplate-empty").show();dumpEmptyFile("nmr",c)}}}};function ontologies_load(a){$(".ontologies_modalTitle").hide();$("#ontologies_show").hide();$("#ontologies_loading").show();if(a=="top"){$("#ontologies_topPeakForest").show();listOntologiesFromPeakForest(a)}else{if(a=="all"){$("#ontologies_allPeakForest").show();listOntologiesFromPeakForest(a)}}}function listOntologiesFromPeakForest(a){$.ajax({type:"get",url:"list-peakforest-ontologies?filter="+a+"",async:true,success:function(b){$("#ontologies_tbody").empty();$("#templateListOntologies").tmpl(b).appendTo("#ontologies_tbody");$.each($(".ontologiesHTML"),function(){$(this).html($(this).text())});$("#ontologies_loading").hide();$("#ontologies_show").show()},error:function(c){console.log(c);var b='<div class="alert alert-danger alert-dismissible" role="alert">';b+='<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only"><spring:message code="alert.close" text="Close" /></span></button>';b+='<strong><spring:message code="alert.strong.warning" text="Warning!" /></strong> could not load ontologies.';b+=" </div>";$("#backOfficeToolsAltert").html(b)}})}$(document).ready(function(){$("#generateFromLCMSmethod").append('<option value="" selected="selected" disabled="disabled"></option>');$("#generateFromLCMSMSmethod").append('<option value="" selected="selected" disabled="disabled"></option>');$.getJSON("resources/json/list-lc-methods.json",function(a){$.each(a.methods,function(){if(this.name!==undefined){if(this.value!==undefined){$("#generateFromLCMSmethod").append('<option value="'+this.value+'">'+this.name+"</option>")}else{$("#generateFromLCMSmethod").append("<option disabled>"+this.name+"</option>")}}})});$.getJSON("resources/json/list-lc-msms-methods.json",function(a){$.each(a.methods,function(){if(this.name!==undefined){if(this.value!==undefined){$("#generateFromLCMSMSmethod").append('<option value="'+this.value+'">'+this.name+"</option>")}else{$("#generateFromLCMSMSmethod").append("<option disabled>"+this.name+"</option>")}}})});$(".downloadTemplateForm").change(function(){var a=$(this).attr("id");switch(a){case"downloadTemplateSpectrumSampleType":if($("#downloadTemplateSpectrumSampleType").val()==SAMPLE_TYPE_ANALYTICAL_MATRIX){$(".downloadTemplateSelectMatrix").show()}else{$(".downloadTemplateSelectMatrix").hide()}if($("#downloadTemplateSpectrumType").val()==""){break}dumpEmptyTemplate();break;case"downloadTemplateSpectrumType":if($("#downloadTemplateSpectrumSampleType").val()==""){break}dumpEmptyTemplate();break;case"downloadTemplatePresfieldY-lcms":$("#generateFromLCMSmethod").val("");$(".downloadTemplateSelectUploadFile-lcms").show();$(".downloadTemplateDownloadFile").hide();break;case"downloadTemplatePresfieldY-lcmsms":$("#generateFromLCMSMSmethod").val("");$(".downloadTemplateSelectUploadFile-lcmsms").show();$(".downloadTemplateDownloadFile").hide();break;case"downloadTemplatePresfieldN-lcms":defaultFileDownload("lcms");break;case"downloadTemplatePresfieldN-lcmsms":defaultFileDownload("lcmsms");break;case"downloadTemplatePresfieldY-nmr":$(".downloadTemplateSelectUploadFile-nmr").show();$(".downloadTemplateDownloadFile").hide();resetNMRFileUpload4Dump();break;case"downloadTemplatePresfieldN-nmr":defaultFileDownload("nmr");break;case"generateFromLCMSmethod":dumpLCSpectralDataFromJson($(this).val());break;case"generateFromLCMSMSmethod":dumpLCSpectralDataFromJson($(this).val());break}})});dumpEmptyTemplate=function(){$(".downloadTemplateUploadFile").hide();$(".downloadTemplateSelectUploadFile").hide();$(".downloadTemplateDownloadFile").hide();$("#generateFromLCMSmethod").val("");$("#generateFromLCMSMSmethod").val("");$("input[name='matrixToDump']").attr("disabled",true);switch($("#downloadTemplateSpectrumType").val()){case"lc-ms":$(".downloadTemplateUploadFile-lcms").show();$("#downloadTemplatePresfieldY-lcms").prop("checked",false);$("#downloadTemplatePresfieldN-lcms").prop("checked",true);defaultFileDownload("lcms");break;case"lc-msms":$(".downloadTemplateUploadFile-lcmsms").show();$("#downloadTemplatePresfieldY-lcmsms").prop("checked",false);$("#downloadTemplatePresfieldN-lcmsms").prop("checked",true);defaultFileDownload("lcmsms");break;case"nmr":$(".downloadTemplateUploadFile-nmr").show();$("#downloadTemplatePresfieldY-nmr").prop("checked",false);$("#downloadTemplatePresfieldN-nmr").prop("checked",true);defaultFileDownload("nmr");break;default:break}};dumpLCSpectralDataFromJson=function(a){$("#generatingTemplate-lcms-file").show();$.getJSON("resources/json/lc-methods/"+a+".json",function(b){dumpJsonDataInXLSMfile(b)}).error(function(c,d,b){if(c.status==404){$(".generatingTemplate").hide();$(".downloadTemplateDownloadFile").show();cleanLinkDnlTemplate();$("#alertBoxDumpTemplate").html(_alert_unablePresFieldData)}})};cleanLinkDnlTemplate=function(){var a=$("div.downloadTemplateDownloadFile a");a.attr("href","");a.html("")};dumpEmptyFile=function(e,a){var b={};if(e=="lcms"){b.dumper_type="lc-ms"}else{if(e=="lcmsms"){b.dumper_type="lc-msms"}else{if(e=="nmr"){b.dumper_type="nmr"}else{b.dumper_type=e}}}if(a!==null&&a!==undefined&&a!=""){var c=false;var d={};switch(a){case SAMPLE_TYPE_CHEMICAL_COMPOUND_LIBRARY:c=true;d.sample_type="reference-chemical-compound";break;case SAMPLE_TYPE_CHEMICAL_COMPOUND_MIX:c=true;d.sample_type="mix-chemical-compound";break;case SAMPLE_TYPE_STANDARDIZED_MATRIX:c=true;d.sample_type="standardized-matrix";break;case SAMPLE_TYPE_ANALYTICAL_MATRIX:c=true;d.sample_type="analytical-matrix";d["analytical-matrix-filter"]=$("input[name='matrixToDump']:checked").val();break;default:break}if(c){b.analytical_sample=d}}$("#generatingTemplate-emtpy").show();dumpJsonDataInXLSMfile(b)};dumpJsonDataInXLSMfile=function(b){var a={};switch($("#downloadTemplateSpectrumSampleType").val()){case"0":a.sample_type="reference-chemical-compound";break;case"1":a.sample_type="mix-chemical-compound";break;case"2":a.sample_type="standardized-matrix";break;case"3":a.sample_type="analytical-matrix";a["analytical-matrix-filter"]=$("input[name='matrixToDump']:checked").val();break;default:return false}b.analytical_sample=a;$("#alertBoxDumpTemplate").html("");$(".downloadTemplateDownloadFile").hide();$("select.downloadTemplateForm").attr("disabled",true);$("#generateFromLCMSmethod").attr("disabled",false);$("#generateFromLCMSMSmethod").attr("disabled",false);$.ajax({type:"post",url:"dumpTemplate",data:JSON.stringify(b),contentType:"application/json",success:function(d){if(d.success){$(".generatingTemplate").hide();$(".downloadTemplateDownloadFile").show();var c=$("div.downloadTemplateDownloadFile a");c.attr("href",d.fileURL);c.html('<i class="fa fa-cloud-download"></i> '+d.fileName)}else{$(".generatingTemplate").hide();$(".downloadTemplateDownloadFile").show();cleanLinkDnlTemplate();$("#alertBoxDumpTemplate").html(_alert_unablePresFieldData)}},error:function(c){$(".generatingTemplate").hide();$(".downloadTemplateDownloadFile").show();cleanLinkDnlTemplate();$("#alertBoxDumpTemplate").html(_alert_unablePresFieldData)}}).always(function(){$(".generatingTemplate").hide()})};var jsonNMRdata={};jsonNMRdata.dumper_type="nmr";resetNMRFileUpload4Dump=function(){$("#uploadMetadataFileNMR_display").val("");$("#uploadSpectrumFileNMR_display").val("");jsonNMRdata={};jsonNMRdata.dumper_type="nmr"};dumpNMRTemplateFromUploadedFiles=function(){$("#generatingTemplate-empty").show();$(".downloadTemplateSelectUploadFile-nmr").hide();dumpJsonDataInXLSMfile(jsonNMRdata)};resetAllDumperForms=function(){$("#downloadTemplateSpectrumSampleType").val("");$("#downloadTemplateSpectrumType").val("");$(".downloadTemplateUploadFile").hide();$(".downloadTemplateSelectUploadFile").hide();$(".downloadTemplateDownloadFile").hide();$(".generatingTemplate").hide();$(".downloadTemplateSelectMatrix").hide();$("#downloadTemplateSpectrumSampleTypeAnalyticalMatrix_source").val("");$("#select2-downloadTemplateSpectrumSampleTypeAnalyticalMatrix_source-container").html("").attr("title","");$("#downloadTemplateSpectrumSampleTypeAnalyticalMatrix_type").val("");$("#select2-downloadTemplateSpectrumSampleTypeAnalyticalMatrix_type-container").html("").attr("title","");$("select.downloadTemplateForm").attr("disabled",false);$("input[name='matrixToDump']").attr("disabled",false).attr("selected",false);$("#dumpTopMatrix").attr("selected",true);resetNMRFileUpload4Dump();cleanLinkDnlTemplate();$("#alertBoxDumpTemplate").html("")};