$(document).ready(function(){var a=document.getElementById("uploadParamFileNMR_file");a.addEventListener("change",function(d){var c=a.files[0];var f=/acqu-.*/;if(c.name.match(f)){$("#uploadMetadataFileNMR_display").val(c.name);var b=new FileReader();b.onload=function(g){$("#generatingTemplate-nmr-device").show();jsonNMRdata.nmr_analyzer={};nmrAcquisitionData={};$.each(b.result.split("\n##"),function(h,e){processNMRfileLine(h,e,false)});if(typeof nmrAcquisitionData.F1==="undefined"||nmrAcquisitionData.F1===null){nmrAcquisitionData.F1=90}$("#generatingTemplate-nmr-device").hide();jsonNMRdata.nmr_analyzer.acquisition=[];jsonNMRdata.nmr_analyzer.acquisition[0]=nmrAcquisitionData};b.readAsText(c)}else{alert("file name does not like: 'acqu-*'")}})});processNMRfileLine=function(b,a,e){if(jsonNMRdata==null){jsonNMRdata={};jsonNMRdata.dumper_type="nmr";jsonNMRdata.nmr_analyzer={}}if(b==0){if(a.match(/TOPSPIN\t\tVersion\s3\.1/)){if(e){$("#software_version").html("TOPSPIN V 3.1")}else{jsonNMRdata.nmr_analyzer.software_version="TopSpin 3.1"}return false}else{if(a.match(/TOPSPIN\t\tVersion\s3\.0/)){if(e){$("#software_version").html("TOPSPIN V 3.0")}else{jsonNMRdata.nmr_analyzer.software_version="TopSpin 3.0"}return false}else{if(a.match(/TOPSPIN\t\tVersion\s2\.1/)){if(e){$("#software_version").html("TOPSPIN V 2.1")}else{jsonNMRdata.nmr_analyzer.software_version="TopSpin 2.1"}return false}}}return false}var h=a.match(/(.*)=(.*)/);if(h){var c=h[1].trim();var g=h[2].trim();switch(c){case"$PULPROG":if(e){$("#PULPROG").html(cleanString(g))}else{nmrAcquisitionData.PULPROG=(cleanString(g))}break;case"$TD":case"$NS":case"$TE":case"$DS":case"$SW":if(e){$("#"+cleanString(c)).html(cleanString(g))}else{var f=nmrAcquisitionData;f[cleanString(c)]=cleanString(g);nmrAcquisitionData=f}break;case"$D":var d=a.split(")")[1].replace(/\n/g," ").split(" ");if(e){$("#D8").html(d[9])}else{nmrAcquisitionData.D8=cleanString(d[9])}break;default:break}return true}return false};cleanString=function(a){return a.replace(/</g,"").replace(/>/g,"").replace(/\$/g,"")};var nmrAcquisitionData={};