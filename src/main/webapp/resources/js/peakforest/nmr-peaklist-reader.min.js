$(document).ready(function(){var a=document.getElementById("uploadSpectrumFileNMR_file");a.addEventListener("change",function(d){var c=a.files[0];var f=/peaklist-.*\.xml/;if(c.name.match(f)){$("#uploadSpectrumFileNMR_display").val(c.name);var b=new FileReader();b.onload=function(h){$("#generatingTemplate-nmr-peaks").show();$("#tbodyPeaklist").empty();$("#tbodyPeakPatternlist").empty();var g=$.parseXML(b.result);parseXMLElement(g,"PeakList",true);$("#generatingTemplate-nmr-peaks").hide()};b.readAsText(c)}else{alert("file name does not like: 'peaklist-.*.xml'")}})});var patternList=[];var peakList=[];var currentPattern=null;var currentPeak=null;function parseXMLElement(a,c,b){$(a).find(c).each(function(g){var j=$(this).attr("id");var i=$(this).text();if(c==="PeakList"){parseXMLElement(this,"PeakList1D");console.log(peakList);console.log(patternList);if(b){if(jsonNMRdata==null){jsonNMRdata={};jsonNMRdata.dumper_type="nmr"}jsonNMRdata.nmr_peaklist=[];currentNMRpeaklistTemplate={};currentNMRpeaklistTemplate.peaklist=peakList;currentNMRpeaklistTemplate.patternlist=patternList;jsonNMRdata.nmr_peaklist[0]=currentNMRpeaklistTemplate}else{htmlRender()}}else{if(c==="PeakList1D"){currentPattern={peaks:[]};parseXMLElement(this,"Peak1D");currentPattern.chemicalShift=getChemicalShift(currentPattern.peaks);switch(currentPattern.peaks.length){case 1:currentPattern.type="s";break;case 2:currentPattern.type="d";break;case 3:currentPattern.type="t";break;default:currentPattern.type="m";break}patternList.push(currentPattern)}else{if(c==="Peak1D"){var f=$(this).attr("F1");var e=$(this).attr("annotation");var d=$(this).attr("intensity");var h=$(this).attr("type");currentPeak={f1:f,annotation:e,intensity:d,type:h};peakList.push(currentPeak);currentPattern.peaks.push(currentPeak)}}}})}getChemicalShift=function(a){var c=0;var b=0;$.each(a,function(d,e){b+=Number(e.f1);c++});if(c!=0){return(b/c)}return 0};htmlRender=function(){};var currentNMRpeaklistTemplate={};