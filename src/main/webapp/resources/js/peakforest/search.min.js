var reopenDetailsModal=false;var reopenDetailsSheet=false;var hideSpectraScoreZero=true;var filterCpd=0;var filterNMR=[];var filterLCMS=[];var filterLCMSMS=[];checkIfReOpenDetailsModal=function(){if(reopenDetailsModal){$("#modalShowCompound").modal("show");reopenDetailsModal=false}};$("body").on("hidden.bs.modal",".modal",function(){$(this).removeData("bs.modal")});$("#search").focus(function(){this.selectionStart=this.selectionEnd=this.value.length});var searchResultsHeight=0;var isCompoundEntityOpen=false;function openCompoundEntity(a,b){isCompoundEntityOpen=true;$.get("sheet-compound/"+a+"/"+b,function(c){$("#divEntityDetails").html(c);$("#compoundResultsTable").hide();$("#spectrumResultsTable").hide();$("#metadataResultsTable").hide();$("#searchForm").hide();$("#searchPagination").hide();$("#divCloseEntity").show();$("#divEntityDetails").show();console.log("entity: ready!");var d=190;$("#entityBody").height($(window).height()-d);$("#entityBody").css("overflow","auto");$("#search-results").css("overflow","hidden");searchResultsHeight=$("#search-results").height();$("#search-results").removeAttr("style")})}function closeCompoundEntity(){isCompoundEntityOpen=false;$("#divCloseEntity").hide();$("#divEntityDetails").html("");$("#divEntityDetails").hide();if($("#compoundResultsTable tr").size()>0){$("#compoundResultsTable").show()}if($("#spectrumResultsTable tr").size()>0){$("#spectrumResultsTable").show()}if($("#metadataResultsTable tr").size()>0){$("#metadataResultsTable").show()}$("#searchForm").show();$("#searchPagination").show();$("#search-results").css("overflow","auto");$("#search-results").height(searchResultsHeight)}var numberMaxResults=10;var compoundsData=new Array();var spectrumData=new Array();var metadataData=new Array();var isMainQueryAnsync=false;var divSearch="search";var inputSearch=$("input#search");if(($(inputSearch).length)&&($("#search").val()!="")){loadSearchResults()}var inputSearchNMR=$("input#searchNMR");if(($(inputSearchNMR).length)&&($("#searchNMR").val()!="")){divSearch="searchNMR";isMainQueryAnsync=true;loadSearchResults()}var inputSearchLCMS=$("input#searchLCMS");if(($(inputSearchLCMS).length)&&($("#searchLCMS").val()!="")){divSearch="searchLCMS";isMainQueryAnsync=true;loadSearchResults()}var inputSearchLCMSMS=$("input#searchLCMSMS");if(($(inputSearchLCMSMS).length)&&($("#searchLCMSMS").val()!="")){divSearch="searchLCMSMS";isMainQueryAnsync=true;loadSearchResults()}var totalElementFound=0;function loadSearchResults(){$(".loadSearchResults").show();$("#compoundResultsTable").hide();$("#spectrumResultsTable").hide();$("#metadataResultsTable").hide();$("#noSearchResults").hide();$("#noLCMSSearchResults").hide();$("#noNMRSearchResults").hide();var k=$.trim($("#"+divSearch).val());if(/^PF(c|s)\d{3,}$/.test(k)){document.location=k;return}var a="query="+k;if(k.startsWith('"')&&k.endsWith('"')){a="query="+$.trim((k).replace(/"/g,""))}else{if(k.indexOf(":")>-1){var c="";var j=null;var g=-1;var n="";var d="";var b="";var i=k.split(" ");var f=false;$.each(i,function(q,u){if(u!=""){var r=u.split(":");if(r!=null&&r.length==2){var e=r[0];var o=r[1];switch(e){case"AVM":var p=o.split("d");var s=p[0];var w=p[1];j="compounds";qFilerType=Utils_SEARCH_COMPOUND_AVERAGE_MASS;n=s;d=w;f=true;break;case"MIM":var p=o.split("d");var s=p[0];var w=p[1];j="compounds";qFilerType=Utils_SEARCH_COMPOUND_MONOISOTOPIC_MASS;n=s;d=w;f=true;break;case"mode":b=o;j="compounds";break;case"FOR":j="compounds";qFilerType=Utils_SEARCH_COMPOUND_FORMULA;n=o;d="";f=true;break;case"NMR":j="nmr-spectra";var t=JSON.parse(o.replace(/=/g,":"));c=t.pl;qFilerType=-1;n=t.d;d=t.mm+"-"+t.pH;break;case"LC-MS":case"LCMS":j="lcms-spectra";var t=JSON.parse(o.replace(/=/g,":"));c=t.pl+";"+t.rtl+";"+t.col;qFilerType=-1;n=t.pol+";"+t.res+";"+t.algo;d=t.dM+";"+t.dT;break;case"LC-MSMS":case"LCMSMS":j="lcmsms-spectra";var t=JSON.parse(o.replace(/=/g,":"));c=JSON.stringify(t.pl);qFilerType=-1;n=t.pol+";"+t.res+";";d=t.P+";"+t.dP+";"+t.dPL;if(t.hasOwnProperty("dmz")){d+=""+t.dmz+";"+t.intexp+";"+t.mzexp+";"}break;default:qFilerEntity="compounds";qFilerType=-1;break}}else{c+=u+" "}}});if($.trim(c)==""&&!f){a="query="+$.trim(k)}else{try{a="query="+$.trim(c)+"&filterEntity="+j+"&filerType="+qFilerType+"&filterVal="+n+"&filterVal2="+d+"&filterVal3="+b}catch(l){a="query="+$.trim(k)}}}}if($.isEmptyObject(compoundsData)&&$.isEmptyObject(spectrumData)&&$.isEmptyObject(metadataData)){var m=[];var h=[];$.ajax({type:"post",url:"search",dataType:"json",async:isMainQueryAnsync,data:a,success:function(w){if(w.success){var p=0;var o=0;var t=0;var e=[];if(w.hasOwnProperty("compoundNames")){$.each(w.compoundNames,function(){try{if(this.compound.id in e){throw false}var y=this.compound.formula;var A=y+"";try{$.each($.unique(y.match(/\d/g)),function(E,F){var D=new RegExp(F,"g");A=A.replace(D,"<sub>"+F+"</sub>")});A=A.replace("</sub><sub>","")}catch(B){}var z="?";if(this.compound.hasOwnProperty("parent")){z="chemical"}if(this.compound.hasOwnProperty("children")){z="generic"}var C=this.compound.containSpectra;var x={name:this.name,id:this.compound.id,formula:A,exactMass:roundNumber(this.compound.monoisotopicMass,7),molWeight:roundNumber(this.compound.averageMass,7),inchikey:this.compound.inChIKey,type:z,spectra:C,pfID:this.compound.pfID};e[this.compound.id]=x;m.push(x);p++}catch(B){console.log(B)}})}if(w.hasOwnProperty("compounds")){$.each(w.compounds,function(){var x=this.mainName;var z=this.formula;var B=z+"";try{$.each($.unique(z.match(/\d/g)),function(F,G){var E=new RegExp(G,"g");B=B.replace(E,"<sub>"+G+"</sub>")});B=B.replace("</sub><sub>","")}catch(C){}var A="?";if(this.hasOwnProperty("parent")){A="chemical"}if(this.hasOwnProperty("children")){A="generic"}var D=this.containSpectra;var y={name:x,id:this.id,formula:B,exactMass:roundNumber(this.monoisotopicMass,7),molWeight:roundNumber(this.averageMass,7),inchikey:this.inChIKey,type:A,spectra:D,pfID:this.pfID};m.push(y);p++})}if(w.hasOwnProperty("nmrCandidates")){var u={};$.each(w.nmrSpectra,function(){u[this.id]=this});console.log(u);$.each(w.nmrCandidates,function(){var E=this.key;E=Number(E.replace("pf:",""));console.log(E);var D=u[E];if(D!==undefined){var x="nmr-light";var F=D.peaks.length;if(F>10){x="nmr-avg"}if(F>20){x="nmr-big"}var y={};if(D.label=="reference"&&D.listOfCompounds.length==1){var z=D.listOfCompounds[0].inChIKey;var C=D.listOfCompounds[0].id;var B="?";if(D.listOfCompounds[0].type==101){B="chemical"}if(D.listOfCompounds[0].type==100){B="generic"}y={id:C,inchikey:z,type:B}}var A={id:D.id,name:D.massBankLikeName,score:this.score,type:"nmr",img:x,compound:y,sampleNMRTubeConditionsMetadata:D.sampleNMRTubeConditionsMetadata,pfID:D.pfID};h.push(A);o++}})}var q=false;var s=false;var v=false;if(w.hasOwnProperty("nmrSpectra")&&!w.hasOwnProperty("nmrCandidates")){$.each(w.nmrSpectra,function(){q=true;var B=this;if(B!==undefined){var D="nmr-light";var E=B.peaks.length;if(E>10){D="nmr-avg"}if(E>20){D="nmr-big"}var z={};if(B.label=="reference"&&B.listOfCompounds.length==1){var C=B.listOfCompounds[0].inChIKey;var x=B.listOfCompounds[0].id;var y="?";if(B.listOfCompounds[0].type==101){y="chemical"}if(B.listOfCompounds[0].type==100){y="generic"}z={id:x,inchikey:C,type:y}}var A={id:B.id,name:B.massBankLikeName,score:roundNumber(this.matchingScore,3),type:"nmr",img:D,compound:z,sampleNMRTubeConditionsMetadata:B.sampleNMRTubeConditionsMetadata,pfID:B.pfID};h.push(A);o++}})}if(w.hasOwnProperty("lcmsSpectra")||w.hasOwnProperty("lcmsmsSpectra")){var r=[];if(w.hasOwnProperty("lcmsSpectra")){r=w.lcmsSpectra}else{r=w.lcmsmsSpectra}$.each(r,function(){s=true;var B=this;if(B!==undefined){var D="lcms-light";var E=B.peaks.length;if(E>10){D="lcms-avg"}if(E>20){D="lcms-big"}var z={};if(B.label=="reference"&&B.listOfCompounds.length==1){var C=B.listOfCompounds[0].inChIKey;var x=B.listOfCompounds[0].id;var y="?";if(B.listOfCompounds[0].type==101){y="chemical"}if(B.listOfCompounds[0].type==100){y="generic"}z={id:x,inchikey:C,type:y}}var A={id:B.id,name:B.massBankName,score:roundNumber(this.matchingScore,3),type:"lcms",img:D,compound:z,pfID:B.pfID};h.push(A);o++}})}if(q&&s){h.sort(function(y,x){return x.score-y.score})}compoundsData=m;spectrumData=h;totalElementFound=p+o+t;filterSearchResults(0,totalElementFound)}else{subjects=[];filterSearchResults(0,0)}},error:function(e){subjects=[];console.log(e);filterSearchResults(0,0)}})}}function filterSearchResults(a,j){a=parseInt(a);j=parseInt(j);setTimeout(function(){var i=location.href;if(i.indexOf("#")>0){i=i.substr(0,i.indexOf("#"))}location.href=i+"#"+a+"-"+j},20);$(".loadSearchResults").show();$("#compoundResultsTable").hide();$("#spectrumResultsTable").hide();$("#spectrumNMRResultsTable").hide();$("#spectrumLCMSResultsTable").hide();$("#spectrumLCMSMSResultsTable").hide();$("#metadataResultsTable").hide();$("#noSearchResults").hide();var k=0;var f=0;var g=new Array();var l=new Array();var b=new Array();var d=false;var c=false;for(var e=0;e<filterNMR.length;e++){if(filterNMR[e]!=null){c=true}}var h=false;for(var e=0;e<filterLCMS.length;e++){if(filterLCMS[e]!=null){h=true}}$.each(spectrumData,function(u,t){if(f>=a){if(c){var p=true;var v=true;var o=true;var r=true;for(var q=0;q<filterNMR.length;q++){if(filterNMR[q]!=null){var n=filterNMR[q];if(n.hasOwnProperty("mfs")){if(!((t.name).toLowerCase().indexOf("-"+n.mfs+"mhz")>=0)){p=false;break}}if(n.hasOwnProperty("pulseq")){if(!((t.name).toUpperCase().indexOf("; "+n.pulseq.toUpperCase()+"")>=0)){v=false;break}}if(n.hasOwnProperty("cpd")){if(!((t.name).toUpperCase().indexOf(""+n.cpd.toUpperCase()+"")>=0)){o=false;break}}if(n.hasOwnProperty("solvent")){if(!((t.sampleNMRTubeConditionsMetadata.solventNMR).toUpperCase().indexOf(""+n.solvent.toUpperCase()+"")>=0)){r=false;break}}}}if(p&&v&&o&&r){l.push(t);k++}}else{if(h){var s=true;var m=true;var o=true;for(var q=0;q<filterLCMS.length;q++){if(filterLCMS[q]!=null){var n=filterLCMS[q];if(n.hasOwnProperty("ioniztionMethod")){if(!((t.name).toUpperCase().indexOf("; LC-"+n.ioniztionMethod+"-")>=0)){s=false;break}}if(n.hasOwnProperty("ionAnalyzer")){if(!((t.name).toUpperCase().indexOf("-"+n.ionAnalyzer.toUpperCase()+"; MS;")>=0)){m=false;break}}if(n.hasOwnProperty("cpd")){if(!((t.name).toUpperCase().indexOf(""+n.cpd.toUpperCase()+"")>=0)){o=false;break}}}}if(s&&m&&o){l.push(t);k++}}else{l.push(t);k++}}if(k>=numberMaxResults){displaySearchResults(g,l,b,a,j);d=true;return false}}f++;if(k>=numberMaxResults){displaySearchResults(g,l,b,a,j);d=true;return false}});if(k>=numberMaxResults){displaySearchResults(g,l,b,a,j);d=true;return false}$.each(compoundsData,function(i,m){if(f>=a){g.push(m);k++;if(k>=numberMaxResults){displaySearchResults(g,l,b,a,j);d=true;return false}}f++});if(!d){displaySearchResults(g,l,b,a,j)}return true}checkIfLoadSubPage=function(){var a=location.href;if(a.indexOf("#")>0){a=a.substr((a.indexOf("#")+1),a.length);var b=a.split("-");if(b.length==2){filterSearchResults(b[0],b[1])}}};if(!isMainQueryAnsync){setTimeout(function(){checkIfLoadSubPage()},50)}var firstLoadTabData=true;function displaySearchResults(i,l,d,c,k){if(firstLoadTabData){$("table").unbind("appendCache applyWidgetId applyWidgets sorton update updateCell").removeClass("tablesorter").find("thead th").unbind("click mousedown").removeClass("header headerSortDown headerSortUp")}var e=false;$(".loadSearchResults").hide();$("#noNMRSearchResults").hide();$("#noLCMSSearchResults").hide();$("#noSearchResults").hide();$("#compoundResultsTableBody").empty();if(!$.isEmptyObject(i)){$("#templateCompounds").tmpl(i).appendTo("#compoundResultsTableBody");$("#compoundResultsTable").show();$.each($(".compoundFormula"),function(n,m){$(m).html($(m).text())})}$("#spectrumResultsTableBody").empty();$("#spectrumNMRResultsTableBody").empty();$("#spectrumLCMSResultsTableBody").empty();$("#spectrumLCMSMSResultsTableBody").empty();if(!$.isEmptyObject(l)){if($($("tbody#spectrumResultsTableBody")).length){$("#templateSpectra").tmpl(l).appendTo("#spectrumResultsTableBody");$("#spectrumResultsTable").show();hideSpectraScoreZeroF("spectrumResultsTableBody")}else{if($($("tbody#spectrumNMRResultsTableBody")).length){$("#templateNMRSpectra").tmpl(l).appendTo("#spectrumNMRResultsTableBody");$("#spectrumNMRResultsTable").show();$("#searchNMRfilterDiv").show();hideSpectraScoreZeroF("spectrumNMRResultsTableBody")}if($($("tbody#spectrumLCMSResultsTableBody")).length){$("#templateLCMSSpectra").tmpl(l).appendTo("#spectrumLCMSResultsTableBody");$("#spectrumLCMSResultsTable").show();$("#searchLCMSfilterDiv").show();hideSpectraScoreZeroF("spectrumLCMSResultsTableBody")}if($($("tbody#spectrumLCMSMSResultsTableBody")).length){$("#templateLCMSMSSpectra").tmpl(l).appendTo("#spectrumLCMSMSResultsTableBody");$("#spectrumLCMSMSResultsTable").show();$("#searchLCMSMSfilterDiv").show();hideSpectraScoreZeroF("spectrumLCMSMSResultsTableBody")}}}if($.isEmptyObject(i)&&$.isEmptyObject(l)){$("#noSearchResults").show();$("#noNMRSearchResults").show();$("#noLCMSSearchResults").show();$("#noLCMSMSSearchResults").show();$("#"+divSearch+"Pagination").html("");return true}computeDisplayCpdInCartList();var a=false;var h=c/numberMaxResults;var g=Math.ceil(k/numberMaxResults);var f="";if(h==0){f+='<li class="disabled"><a href="#">&laquo;</a></li>';e=true}else{f+='<li><a href="#" onclick="filterSearchResults(0, '+k+');">&laquo;</a></li>'}if(h>=3){if(h!=3){f+='<li class="disabled"><a href="#">&hellip;</a></li>'}var j=c-numberMaxResults-(2*numberMaxResults);f+='<li><a href="#" onclick="filterSearchResults('+j+", "+k+');">'+(h-2)+"</a></li>"}if(h>=2){var j=c-numberMaxResults-(1*numberMaxResults);f+='<li><a href="#" onclick="filterSearchResults('+j+", "+k+');">'+(h-1)+"</a></li>"}if(h>=1){a=true;var j=c-numberMaxResults;f+='<li><a href="#" onclick="filterSearchResults('+j+", "+k+');">'+(h)+"</a></li>"}f+='<li class="active"><a href="#">'+(h+1)+"</a></li>";if((h+1)<g){a=true;var b=c+numberMaxResults;f+='<li><a href="#" onclick="filterSearchResults('+b+", "+k+');">'+(h+2)+"</a></li>"}if((h+2)<g){var b=c+numberMaxResults+(1*numberMaxResults);f+='<li><a href="#" onclick="filterSearchResults('+b+", "+k+');">'+(h+3)+"</a></li>"}if((h+3)<g){var b=c+numberMaxResults+(2*numberMaxResults);f+='<li><a href="#" onclick="filterSearchResults('+b+", "+k+');">'+(h+4)+"</a></li>"}if((h+4)<g){f+='<li class="disabled"><a href="#">&hellip;</a></li>'}if((h+1)==g){f+='<li class="disabled"><a href="#">&raquo;</a></li>'}else{var b=(g)*numberMaxResults-numberMaxResults;f+='<li><a href="#" onclick="filterSearchResults('+b+", "+k+');">&raquo;</a></li>'}if(a){$("#"+divSearch+"Pagination").html(f);$("#"+divSearch+"Pagination").show()}if(firstLoadTabData){setTimeout(function(){$("#compoundResultsTable").tablesorter();$("#spectrumResultsTable").tablesorter();$("#spectrumNMRResultsTable").tablesorter();$("#spectrumLCMSResultsTable").tablesorter();$("#spectrumLCMSMSResultsTable").tablesorter()},150)}setTimeout(function(){$("table").trigger("update")},300);setTimeout(resizeMainPanel(),50);firstLoadTabData=false;return true}$("#searchButton").click(function(){if($("#search").val()!=""){$("#searchForm").submit()}});var subjects=[];$("#search").typeahead({source:function(a,b){return searchAjax()}});$("#search").bind("keypress",function(f){var d=f.keyCode||f.which;if(d==13&&$("#search").val()!=""){$("#searchForm").submit()}if(d==32&&$("#search").val()!=""){var c=$("#search").parent().find("ul");if($(c).is(":visible")){var b=$(c).find("li");for(var a=0;a<b.length;a++){if($(b[a]).hasClass("active")&&a>0){$("#search").val($(b[a]).text())}}}}}).focus();searchAjax=function(){var a=[];var b=($("#search").val()).trim();a.push(b);if(b.length>2){$.ajax({type:"post",url:"search",dataType:"json",async:false,data:"query="+($("#search").val()).trim()+"&quick=true",success:function(c){if(c.success){$.each(c.compoundNames,function(){if($.inArray(this.name,a)===-1){a.push(this.name)}});$.each(c.compounds,function(){if(this.inChIKey.indexOf(b)){if($.inArray(this.inChIKey,a)===-1){a.push(this.inChIKey)}}if(this.formula.indexOf(b)){if($.inArray(this.formula,a)===-1){a.push(this.formula)}}});a=matchingSpectraKeywords(b,a)}},error:function(c){subjects=[];console.log(c)}})}if(a.length==1){return(new Array())}return a};matchingSpectraKeywords=function(a,d){var g="";var e=a.split(" ");for(var c in e){var b=e[c];if(b.toLowerCase().startsWith("nm")){g=g+"NMR"}else{if(b.toLowerCase().startsWith("40")){g=g+"400"}else{if(b.toLowerCase().startsWith("50")){g=g+"500"}else{if(b.toLowerCase().startsWith("60")){g=g+"600"}else{if(b.toLowerCase().startsWith("70")){g=g+"700"}else{if(b.toLowerCase().startsWith("75")){g=g+"750"}else{if(b.toLowerCase().startsWith("80")){g=g+"800"}else{if(b.toLowerCase().startsWith("85")){g=g+"850"}else{if(b.toLowerCase().startsWith("90")){g=g+"900"}else{if(b.toLowerCase().startsWith("10")){g=g+"1000"}else{if(b.toLowerCase().startsWith("12")){g=g+"1200"}else{if(b.toLowerCase().startsWith("pr")){g=g+"proton"}else{if(b.toLowerCase().startsWith("no")){d.push("NOESY-1D");d.push("NOESY-2D");g=g+" "}else{if(b.toLowerCase().startsWith("cp")){g=g+"CPMG"}else{if(b.toLowerCase().startsWith("car")){g=g+"Carbon-13"}else{if(b.toLowerCase().startsWith("co")){g=g+"COSY-2D"}else{if(b.toLowerCase().startsWith("jr")){g=g+"JRES"}else{if(b.toLowerCase().startsWith("to")){g=g+"TOCSY-2D"}else{if(b.toLowerCase().startsWith("hm")){g=g+"HMBC-2D"}else{if(b.toLowerCase().startsWith("hs")){g=g+"HSQC-2D"}else{if(b.toLowerCase().startsWith("lc")){g=g+"LC-MS"}else{if(b.toLowerCase().startsWith("to")){g=g+"TOF"}else{if(b.toLowerCase().startsWith("qt")){g=g+"QTOF"}else{if(b.toLowerCase().startsWith("qq")){g=g+"QQQ"}else{if(b.toLowerCase().startsWith("lc-msm")||b.toLowerCase().startsWith("lc-ms2")){g=g+"LC-MSMS"}else{if(b.toLowerCase().startsWith("pos")){g=g+"positive"}else{if(b.toLowerCase().startsWith("neg")){g=g+"negative"}else{if(b.toLowerCase().startsWith("hig")){g=g+"High"}else{if(b.toLowerCase().startsWith("low")){g=g+"Low"}else{g=g+b}}}}}}}}}}}}}}}}}}}}}}}}}}}}}g=g+" "}var f=(g.trim());if($.inArray(f,d)===-1){d.push(f)}return d};var isAdvancedModalLoaded=false;$("#advancedBtn").click(function(){if(isAdvancedModalLoaded){$("#advancedModal").modal("show");loadRawQuery()}else{$("#advancedModal .modal-dialog").load("search-advanced-modal",function(){$("#advancedModal").modal("show");isAdvancedModalLoaded=true})}});$("#filterNMRtype").change(function(){var a=$("#filterNMRtype").val();switch(a){case"1":$(".filterType").hide();$("#filterNMRmagneticValue").show();break;case"2":$(".filterType").hide();$("#filterNMRpulseqValue").show();break;case"3":$(".filterType").hide();$("#filterNMRtextValue").show();break;case"4":$(".filterType").hide();$("#filterNMRsolventValue").show();break}});hideshow=function(b){var a=$("#"+b);if($(a).is(":visible")){$("#"+b).hide()}else{$("#"+b).show()}};addNMRfilter=function(){var b=$("#filterNMRtype").val();var c="";var a="";switch(b){case"1":var c=$("#filterNMRmagneticValue").val();filterNMR[filterCpd]={mfs:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__MAGNETIC_FIELD+": "+c+' | <a href="#" onclick="removeNMRfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break;case"2":var c=$("#filterNMRpulseqValue").val();filterNMR[filterCpd]={pulseq:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__PULSE_SEQ+": "+c+' | <a href="#" onclick="removeNMRfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break;case"3":var c=$("#filterNMRtextValue").val();filterNMR[filterCpd]={cpd:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__CPD_NAME+": "+c+' | <a href="#" onclick="removeNMRfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break;case"4":var c=$("#filterNMRsolventValue").val();filterNMR[filterCpd]={solvent:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__SOLVENT+": "+c+' | <a href="#" onclick="removeNMRfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break}$("#filterNMRdisplay").append(a);filterSearchResults(0,totalElementFound);filterCpd++};removeNMRfilter=function(a){filterNMR[a]=null;filterSearchResults(0,totalElementFound);$("#filter"+a).remove()};var isNMRModalLoaded=false;openNMRtoolbox=function(){if(isNMRModalLoaded){$("#NMRModal").modal("show");loadRawQueryNMR()}else{$("#NMRModal .modal-dialog").load("peakmatching-nmr-query-modal",function(){$("#NMRModal").modal("show");isNMRModalLoaded=true})}};$("#peakmatchingNMRmodalBtn").click(function(){openNMRtoolbox()});$("#searchNMR").click(function(){openNMRtoolbox()});$("#filterLCMStype").change(function(){var a=$("#filterLCMStype").val();switch(a){case"1":$(".filterType").hide();$("#filterLCMIonizationMethodValue").show();break;case"2":$(".filterType").hide();$("#filterLCMStextIonAnalyzerValue").show();break;case"3":$(".filterType").hide();$("#filterLCMStextCpdNameValue").show();break}});addLCMSfilter=function(){var b=$("#filterLCMStype").val();var c="";var a="";switch(b){case"1":var c=$("#filterLCMIonizationMethodValue").val();filterLCMS[filterCpd]={ioniztionMethod:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__IONIZATION_METHOD+": "+c+' | <a href="#" onclick="removeLCMSfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break;case"2":var c=$("#filterLCMStextIonAnalyzerValue").val();filterLCMS[filterCpd]={ionAnalyzer:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__ION_ANALYZER+": "+c+' | <a href="#" onclick="removeLCMSfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break;case"3":var c=$("#filterLCMStextCpdNameValue").val();filterLCMS[filterCpd]={cpd:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__CPD_NAME+": "+c+' | <a href="#" onclick="removeLCMSfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break}$("#filterLCMSdisplay").append(a);filterSearchResults(0,totalElementFound);filterCpd++};removeLCMSfilter=function(a){filterLCMS[a]=null;filterSearchResults(0,totalElementFound);$("#filter"+a).remove()};var isLCMSModalLoaded=false;openLCMStoolbox=function(){if(isLCMSModalLoaded){$("#LCMSModal").modal("show");loadRawQueryLCMS()}else{$("#LCMSModal .modal-dialog").load("peakmatching-lcms-query-modal",function(){$("#LCMSModal").modal("show");isLCMSModalLoaded=true})}};$("#peakmatchingLCMSmodalBtn").click(function(){openLCMStoolbox()});$("#searchLCMS").click(function(){openLCMStoolbox()});$("#filterLCMSMStype").change(function(){var a=$("#filterLCMSMStype").val();switch(a){case"1":$(".filterType").hide();$("#filterLCMSMSIonizationMethodValue").show();break;case"2":$(".filterType").hide();$("#filterLCMSMStextIonAnalyzerValue").show();break;case"3":$(".filterType").hide();$("#filterLCMSMStextCpdNameValue").show();break}});addLCMSMSfilter=function(){var b=$("#filterLCMSMStype").val();var c="";var a="";switch(b){case"1":var c=$("#filterLCMSMSIonizationMethodValue").val();filterLCMSMS[filterCpd]={ioniztionMethod:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__IONIZATION_METHOD+": "+c+' | <a href="#" onclick="removeLCMSMSfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break;case"2":var c=$("#filterLCMSMStextIonAnalyzerValue").val();filterLCMSMS[filterCpd]={ionAnalyzer:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__ION_ANALYZER+": "+c+' | <a href="#" onclick="removeLCMSMSfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break;case"3":var c=$("#filterLCMSMStextCpdNameValue").val();filterLCMSMS[filterCpd]={cpd:c};a='<span id="filter'+filterCpd+'"><span class="label label-warning ">'+TXT_LABEL__CPD_NAME+": "+c+' | <a href="#" onclick="removeLCMSMSfilter('+filterCpd+');"class="">&times;</a></span><span>&nbsp;</span></span>';break}$("#filterLCMSMSdisplay").append(a);filterSearchResults(0,totalElementFound);filterCpd++};removeLCMSMSfilter=function(a){filterLCMSMS[a]=null;filterSearchResults(0,totalElementFound);$("#filter"+a).remove()};var isLCMSMSModalLoaded=false;openLCMSMStoolbox=function(){if(isLCMSMSModalLoaded){$("#LCMSMSModal").modal("show");loadRawQueryLCMSMS()}else{$("#LCMSMSModal .modal-dialog").load("peakmatching-lcmsms-query-modal",function(){$("#LCMSMSModal").modal("show");isLCMSMSModalLoaded=true})}};$("#peakmatchingLCMSMSmodalBtn").click(function(){openLCMSMStoolbox()});$("#searchLCMSMS").click(function(){openLCMSMStoolbox()});$(document).ready(function(){$("#link-pm-nmr").click(function(){if(($($("#searchNMR")).length)&&$("#searchNMR").val().trim()==""){$("#peakmatchingNMRmodalBtn").click()}});$("#link-pm-lcms").click(function(){if(($($("#searchLCMS")).length)&&$("#searchLCMS").val().trim()==""){$("#peakmatchingLCMSmodalBtn").click()}});$("#link-pm-lcmsms").click(function(){if(($($("#searchLCMSMS")).length)&&$("#searchLCMSMS").val().trim()==""){$("#peakmatchingLCMSMSmodalBtn").click()}})});function hideSpectraScoreZeroF(a){if(hideSpectraScoreZero){var b=false;$.each($("#"+a+" tr"),function(){var c=$(this);if($($(c).find("td")[1]).html()=="0"){$(c).hide();b=true}});if(b){$("#"+a+"").append('<tr id="lineBtnShowMore"><td colspan="4"><button class="btn btn-primary" onclick="showSpectraScoreZero(\''+a+'\')"><i class="fa fa-eye"></i> '+_txt_btn_showMode+"</button></td></tr>");setTimeout(function(){if($("#searchPagination").find("li.active a").html()=="1"){$("#searchPagination").hide()}},50)}}}function showSpectraScoreZero(a){hideSpectraScoreZero=false;$("#searchPagination").show();$("#lineBtnShowMore").remove();$("#"+a+" tr").show()};